#!/usr/bin/env python

import optparse,os

parser = optparse.OptionParser()
parser.add_option("", "--prefix", dest="prefix",default="/usr/local",help="installation prefix (default: /usr/local)")
parser.add_option("", "--port", dest="port", default="8080", help="set the listening TCP port (default: 8080)")
parser.add_option("", "--command", dest="cmd", default=None,help="set the command (default: /bin/login or ssh localhost)")
(o, a) = parser.parse_args()

print "Configuring prefix=",o.prefix," port=",o.port

bin=os.path.join(o.prefix,"bin")
lib=os.path.join(o.prefix,"lib/ajaxterm")
port=o.port
cmd=o.cmd

file("ajaxterm.bin","w").write('#!/bin/sh\nexec "%(lib)s/ajaxterm.py" "$@"\n'%locals())
file("Makefile","w").write(file("configure.makefile").read()%locals())
file("ajaxterm.initd","w").write(file("configure.initd.debian").read()%locals())

os.system("chmod a+x ajaxterm.bin")
os.system("chmod a+x ajaxterm.initd")
